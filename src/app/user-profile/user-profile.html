@if (loading) {
  <div class="profile-card">Loading‚Ä¶</div>
} @else if (profile) {
  <div class="profile-card">
    <div class="avatar" [style.background]="profile.avatarColor || null">
      {{ getInitials(profile.displayName) }}
    </div>

    <div class="name-row">
      <h2>{{ profile.displayName }}</h2>
      @if (profile.skillLevel) {
        <span class="skill-badge">{{ profile.skillLevel }}</span>
      }
    </div>

    @if (profile.role) { <div class="role">{{ profile.role }}</div> }
    @if (profile.showEmail && profile.email) { <div class="email">{{ profile.email }}</div> }
    @if (profile.location) { <div class="location">üìç {{ profile.location }}</div> }

    <p class="bio">{{ profile.bio }}</p>

    @if (profile.languages?.length) {
      <div class="lang-tags">
        @for (lang of profile.languages!; track lang) {
          <span class="lang-tag">{{ lang }}</span>
        }
      </div>
    }

    <div class="profile-stats">
      <span><strong>{{ profile.followerCount || 0 }}</strong> followers</span>
      <span><strong>{{ profile.followingCount || 0 }}</strong> following</span>
    </div>

    <div class="profile-links">
      @if (profile.githubUrl) {
        <a class="ext-link" [href]="profile.githubUrl" target="_blank" rel="noopener noreferrer">GitHub ‚Üó</a>
      }
      @if (profile.websiteUrl) {
        <a class="ext-link" [href]="profile.websiteUrl" target="_blank" rel="noopener noreferrer">Website ‚Üó</a>
      }
    </div>

    @if (!isOwnProfile) {
      @let following = (isFollowing$ | async) ?? false;
      <button class="follow-btn" [class.following]="following" (click)="toggle(following)">
        {{ following ? 'Unfollow' : 'Follow' }}
      </button>
    }
  </div>
} @else {
  <div class="profile-card">User not found.</div>
}
