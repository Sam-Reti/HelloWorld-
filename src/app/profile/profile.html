@if (loading) {
  <div class="profile-card">Loading‚Ä¶</div>
} @else if (profile) {
  <div class="profile-card">
    <div class="avatar" [style.background]="profile.avatarColor || '#0ea5a4'">
      {{ getInitials(profile.displayName || email) }}
    </div>

    <div class="name-row">
      <h2>{{ profile.displayName || 'Set your display name' }}</h2>
      @if (profile.skillLevel) {
        <span class="skill-badge">{{ profile.skillLevel }}</span>
      }
    </div>

    @if (profile.role) {
      <div class="role">{{ profile.role }}</div>
    }
    <div class="email">{{ email || '' }}</div>
    @if (profile.location) {
      <div class="location">üìç {{ profile.location }}</div>
    }

    <p class="bio">{{ profile.bio || "Add a short bio so people know what you're learning." }}</p>

    @if (profile.languages?.length) {
      <div class="lang-tags">
        @for (lang of profile.languages!; track lang) {
          <span class="lang-tag">{{ lang }}</span>
        }
      </div>
    }

    <div class="profile-stats">
      <span
        ><strong>{{ profile.followerCount || 0 }}</strong> followers</span
      >
      <span
        ><strong>{{ profile.followingCount || 0 }}</strong> following</span
      >
    </div>

    <div class="profile-links">
      @if (profile.githubUrl) {
        <a class="ext-link" [href]="profile.githubUrl" target="_blank" rel="noopener noreferrer"
          >GitHub ‚Üó</a
        >
      }
      @if (profile.websiteUrl) {
        <a class="ext-link" [href]="profile.websiteUrl" target="_blank" rel="noopener noreferrer"
          >Website ‚Üó</a
        >
      }
    </div>

    <a class="edit-link" routerLink="/app-home/edit-profile">Edit Profile</a>

    <div class="theme-section">
      <div class="theme-section-label">Appearance</div>

      <div class="theme-group">
        <div class="theme-mode-label">Light</div>
        <div class="swatches">
          @for (t of lightThemes; track t.id) {
            <button
              class="swatch"
              [class.active]="activeTheme === t.id"
              [style.background]="t.accent"
              [title]="t.name"
              (click)="selectTheme(t.id)"
            ></button>
          }
        </div>
      </div>

      <div class="theme-group">
        <div class="theme-mode-label">Dark</div>
        <div class="swatches">
          @for (t of darkThemes; track t.id) {
            <button
              class="swatch"
              [class.active]="activeTheme === t.id"
              [style.background]="t.accent"
              [title]="t.name"
              (click)="selectTheme(t.id)"
            ></button>
          }
        </div>
      </div>
    </div>
  </div>
} @else {
  <div class="profile-card">Could not load profile.</div>
}
